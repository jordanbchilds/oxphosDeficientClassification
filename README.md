# Introduction

Data and R scripts associated with the paper `Bayesian classification of OXPHOS skeletal myofibres` by Childs *et al.*. 
A prepped version of the data, originally published by [Vincent *et al.*](https://www.sciencedirect.com/science/article/pii/S0925443924001200), is available in the file `data_prepped.csv`. 

## Obsersed Data Inference

All R scripts relating to the observed IMC dataset can be found in `Rscripts` directory. To execute the model inference presented in the papaer execute the script `Rscripts/inference.R` - 
package `analysis2Dmito` must be installed first, available through its [GitHub page](https://github.com/jordanbchilds/analysis2Dmito). Note that a C++ toolchain must be setup to enable 
the use of STAN, links are provided in the package README which should help. The script `Rscripts/inference.R`, run three independent inference chains and saves them in a folder named 
`Output`, not a directory in the repository but created by the script. Executing `Rscripts/saveMaxESSOutput.R` will compare the independent inference chains for each 2Dmito plot and save 
the one with the highest minimum effective sample size of the parameters to a new folder `outputMaxESS`. Plots can then be made using the files; `analysis_plotter.R` and `paper_plots.R` 
in the `Rscripts` directory. R scripts should be executed in the order `inference.R`, `saveMaxESSOutput.R`, `analysis_plotter.R`. 

## Simualtion Study

All files related to the simulation study are found in the directory `SimulationStudy`, importantly R scripts relavent to the study are found within the directory `SimulationStudy/Rscipts`. 
Synthetic data is saved in the directory `SimulationStudy/Data` but can also be generated by executing the script `SimulationStudy/Rscripts/generateSyntheticData.R`. Inference for synthetic
data is executed in the `SimulationStudy/Rscripts/inference.R`. Similarly to the observed data, the scripts execute three indepenedent chains and the chain with the highest minimum effective
sample size for an individual parameters is saved to a seperate folder. In general, R scripts should be executed in the order `inference.R`, `saveMaxESSOutput.R`, `analysis_plotter.R`. 
